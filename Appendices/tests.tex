\chapter{Tests}


\section{Pictures}


% example for the protocol chapter... instead of the tables....

\subsection{Protocol boxes}

A bit cumbersome and we would need to have text at defined locations. Perhaps keep the simple table in the protocol chapter.

\begin{center}
\begin{tikzpicture}[scale=0.9, transform shape]

    \draw[help lines, gray!50, dashed] (0,0) grid( 16,8);

    \node[  draw, 
            tsRoundedRectangle, 
            minimum width=6cm, 
            minimum height=4cm, 
            text height=1cm, 
            align=left] (A) at (4, 4) 
            { };

    \node[  draw, 
            tsRoundedRectangle, 
            minimum width=6cm, 
            minimum height=4cm, 
            text height=1cm, 
            align=left] (B) at (12, 4) 
            { };

    \draw[->] (A.north east) ++(0, -1) -- ($(B.west) + (0, 1 )$);
    \draw[->] (B.south west) ++(0,  1) -- ($(A.east) + (0, -1)$);

    \node at ( 4,  6.25 ) {\textbf{Node A}};
    \node at ( 12, 6.25 ) {\textbf{Node B}};

    \node at ( 2.25,  5 ) {\textbf{LCS\_TOF}};
    \node at ( 10.25, 3 ) {\textbf{LCS\_TOF}};

\end{tikzpicture}
\end{center}


\subsection{Block Node boxes}


% Command: \rectwithports{west count}{east count}{width}{rectID}{x}{y}
\newcommand{\rectwithports}[6]{%
    % #1 = west count, #2 = east count
    % #3 = width, #4 = rectID, #5 = x pos, #6 = y pos
    \pgfmathsetmacro{\nports}{max(#1,#2)}
    \pgfmathsetmacro{\h}{\nports*0.4} % rectangle height

    % Rectangle
    \node[draw, rectangle, minimum width=#3, minimum height=\h cm] (rect#4) at (#5,#6) {};

    % West ports
    \foreach \i in {1,...,#1} {
        \node[circle, draw, fill=green, inner sep=0pt, minimum size=6pt]
            (W#4\i) at ($(rect#4.west) + (0,{(#1-2*\i+1)*0.5*0.4})$) {};
    }

    % East ports
    \foreach \i in {1,...,#2} {
        \node[circle, draw, fill=green, inner sep=0pt, minimum size=6pt]
            (E#4\i) at ($(rect#4.east) + (0,{(#2-2*\i+1)*0.5*0.4})$) {};
    }
}

% Command: \connectports[<TikZ options>]{srcRectID}{srcSide}{srcPort}{dstRectID}{dstSide}{dstPort}
\newcommand{\connectports}[7][]{%
    % Build node names
    \edef\srcnode{#3#2#4}
    \edef\dstnode{#6#5#7}

    % Determine start and end coordinates
    \coordinate (start) at (\srcnode.center);
    \coordinate (end) at (\dstnode.center);

    % Adjust start/end to the correct side of the port
    \ifthenelse{\equal{#2}{E}}{\coordinate (start) at (\srcnode.west);}{\coordinate (start) at (\srcnode.east);}
    \ifthenelse{\equal{#5}{E}}{\coordinate (end) at (\dstnode.east);}{\coordinate (end) at (\dstnode.west);}

    % Draw orthogonal line (Manhattan style)
    \draw[-, #1] (start) -- (end);
}



\begin{tikzpicture}
  % Draw rectangles
  \rectwithports{2}{2}{2cm}{1}{0}{0}    % rectID=1 at (0,0)
  \rectwithports{3}{1}{4cm}{2}{6}{0}    % rectID=2 at (6,0)
  \rectwithports{3}{1}{4cm}{3}{12}{0}   % rectID=3 at (12,0)

  % Connect ports
  \connectports[->, red, thick]{1}{E}{1}{2}{W}{2}   % rect 1 E1 -> rect 2 W2
  \connectports[->, blue, thick]{2}{E}{1}{3}{W}{1}  % rect 2 E1 -> rect 3 W1
\end{tikzpicture}

